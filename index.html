<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>vuejs2rumentg</title>
  <!--<link rel="stylesheet" href="static/lib/led.css">-->
  <script src="static/lib/vue.js"></script>
</head>
<style>
  #app{
    position: absolute;
    left:0;top:0;right:0;bottom:0;
    overflow:hidden;
    outline:none;
    background:url(static/img/sky.jpg) repeat;
    color:white;
  }
  #app .square{
    position:absolute;
    font-size:50px;
    color:#7a6e6e;
    transition:transform .5s;
  }
</style>
<body>
<div id="app"
     tabindex=1
     @keydown.up='move("up",5,5)'
     @keydown.down='move("down",5,5)'
     @keydown.left='move("left",5,5)'
     @keydown.right='move("right",5,5)'
     :style="{'background-position':bgpos[0]+'px ' + bgpos[1] + 'px' }"
>
  <h1>开车吧，老司机</h1>
  <div class="square fa fa-space-shuttle"
       :style="{left:pos.left+'px',top:pos.top+'px',transform:tx}"></div>
</div>
<!-- built files will be auto injected -->
<script>
  var vm = new Vue({
    el: '#app',
    data:{
      tx:'rotate(-90deg)',
      pos:{
        left:300,
        top:150
      },
      bgpos:[0,0],
      dir:'up'
    },
    created:function(){
      var self = this;
      var step = function(){
        self.move(self.dir,0,1);
        self.$forceUpdate();
        requestAnimationFrame(step);
      };
      requestAnimationFrame(step);
    },
    methods:{
      move:function(dir,fgstep,bgstep){
        this.dir = dir;
        switch(dir){
          case 'left':
            this.pos.left -= fgstep;
            this.tx = 'rotate(-180deg)';
            this.bgpos[0] +=bgstep;
            break;
          case 'right':
            this.pos.left += fgstep;
            this.tx = 'rotate(0deg)';
            this.bgpos[0] -=bgstep;
            break;
          case 'up':
            this.pos.top -= fgstep;
            this.tx = 'rotate(-90deg)';
            this.bgpos[1] +=bgstep;
            break;
          case 'down':
            this.pos.top += fgstep;
            this.tx = 'rotate(90deg)';
            this.bgpos[1] -=bgstep;
            break;
        }
      }
    }
  });
</script>
</body>
</html>
